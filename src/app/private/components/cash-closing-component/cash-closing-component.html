<div animateLoad="zoomIn"
    class="bg-white w-full h-full md:w-auto md:h-auto md:max-w-4xl md:max-h-[90vh] md:rounded-lg p-4 md:p-6 text-sm flex flex-col gap-4 shadow-lg overflow-hidden">
    <div class="flex justify-between items-center border-b pb-4">
        <h1 class="text-2xl font-bold text-gray-800">Cerrar caja</h1>
    </div>

    <p class="text-gray-600">
        Revise la informaci√≥n de las ventas antes de proceder.
    </p>
    <div class="overflow-x-auto max-h-[60vh] border rounded-lg">
        <!-- Desktop Table -->
        <table class="hidden md:table w-full divide-y divide-gray-200">
            <thead class="bg-gray-50 sticky top-0">
                <tr>
                    <th scope="col"
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Hora</th>
                    <th scope="col"
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Monto
                    </th>
                    <th scope="col"
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tipo</th>
                    <th scope="col"
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                        Comentarios</th>
                    <th scope="col"
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                        Acciones</th>
                </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
                @for(sell of sells(); track sell.id){
                <tr class="hover:bg-gray-50 transition-colors">
                    <td class="px-6 py-4 whitespace-nowrap text-gray-700 font-medium">
                        {{ sell.date |date:'HH:mm'}}
                        @if(sell.history && sell.history.length > 0){<span class="text-orange-500 font-bold ml-1"
                            title="Venta editada">*</span>}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-green-600 font-semibold">
                        {{ sell.amount }}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span
                            class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">
                            {{ sell.type }}
                        </span>
                    </td>
                    <td class="px-6 py-4 text-gray-500 max-w-xs truncate" title="{{sell.comments}}">
                        {{ sell.comments || '-' }}
                    </td>
                    <td class="px-6 py-4">
                        <button
                            class="text-blue-600 hover:text-blue-800 font-medium text-xs border border-blue-600 hover:bg-blue-50 px-3 py-1 rounded transition-colors"
                            (click)="editSell(sell)">
                            Editar
                        </button>
                    </td>
                </tr>
                } @empty {
                <tr>
                    <td colspan="5" class="px-6 py-10 text-center text-gray-500">
                        No hay ventas registradas para este cierre.
                    </td>
                </tr>
                }
            </tbody>
        </table>

        <!-- Mobile Cards -->
        <div class="md:hidden flex flex-col gap-3 p-2">
            @for(sell of sells(); track sell.id){
            <div class="bg-white p-4 rounded shadow border border-gray-100">
                <div class="flex justify-between items-center mb-2">
                    <span class="font-bold text-green-600 text-lg">${{ sell.amount }}</span>
                    <span class="px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800">
                        {{ sell.type }}
                    </span>
                </div>
                <div class="flex justify-between items-center text-xs text-gray-500 mb-2">
                    <span>
                        {{ sell.date | date:'HH:mm' }}
                        @if(sell.history && sell.history.length > 0){<span class="text-orange-500 font-bold ml-1"
                            title="Venta editada">*</span>}
                    </span>
                </div>
                @if(sell.comments) {
                <div class="text-sm text-gray-600 bg-gray-50 p-2 rounded italic mb-2">
                    {{ sell.comments }}
                </div>
                }

                <div class="flex justify-end">
                    <button
                        class="text-blue-600 hover:text-blue-800 font-medium text-xs border border-blue-600 hover:bg-blue-50 px-3 py-1 rounded transition-colors"
                        (click)="editSell(sell)">
                        Editar
                    </button>
                </div>
            </div>
            } @empty {
            <div class="py-10 text-center text-gray-500 italic">
                No hay ventas registradas para este cierre.
            </div>
            }
        </div>
    </div>

    <div class="flex justify-end border-t pt-4">
        <div class="flex flex-col items-end">
            <span class="text-gray-600 text-sm">Total ingresado:</span>
            <span class="text-3xl font-bold text-green-600">${{ totalAmount() }}</span>
        </div>
    </div>

    <div class="flex sm:flex-row justify-end gap-3 pt-4 border-t mt-auto">
        <button
            class="w-full sm:w-auto bg-green-500 hover:bg-green-600 text-white font-bold py-3 sm:py-2 px-6 rounded shadow transition-transform transform active:scale-95"
            (click)="cashClose()">
            Cerrar caja
        </button>
        <button
            class="w-full sm:w-auto bg-red-500 hover:bg-red-600 text-white font-bold py-3 sm:py-2 px-6 rounded shadow transition-transform transform active:scale-95"
            (click)="close()">
            Cancelar
        </button>
    </div>
</div>