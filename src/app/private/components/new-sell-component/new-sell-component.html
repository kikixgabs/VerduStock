<div animateLoad="zoomIn"
    class="flex flex-col justify-center gap-4 p-4 border bg-gray-200 w-full mx-auto h-auto md:h-full border-gray-200 rounded">
    <div class="flex text-2xl font-bold pb-4">
        {{ isEditing() ? 'Editar Venta' : 'Nueva Venta' }}
    </div>
    <div class="flex flex-col gap-4 w-full">
        <div class="flex gap-4 w-full">
            <div class="flex flex-col w-1/2 gap-2">
                <span>Monto:</span>
                <input class="w-full border border-black rounded p-2" [(ngModel)]="amount" placeholder="0" type="number"
                    id="amount" (keydown)="preventAlphabetical($event)">
            </div>
            <div class="flex flex-col w-1/2 gap-2">
                <span>Tipo de Pago:</span>
                <select class="w-full border border-black rounded p-2" [(ngModel)]="type" name="type" id="type">
                    <option [value]="SellType.CASH">{{SellType.CASH}}</option>
                    <option [value]="SellType.TRANSFER">{{SellType.TRANSFER}}</option>
                    <option [value]="SellType.CREDIT">{{SellType.CREDIT}}</option>
                    <option [value]="SellType.DEBIT">{{SellType.DEBIT}}</option>
                </select>
            </div>
        </div>
        <div class="flex flex-col gap-2">
            <span>Comentarios:</span>
            <textarea [(ngModel)]="comments" name="comments" id="comments"
                class="w-full border border-black rounded p-2" rows="5"></textarea>
        </div>

        @if(isEditing() && originalSell?.history && originalSell!.history!.length > 0) {
        <div class="mt-4 border-t pt-2">
            <span class="font-bold text-gray-700 block mb-2">Historial de Cambios:</span>
            <div class="flex flex-col gap-2 max-h-40 overflow-y-auto bg-white p-2 rounded border">
                @for(change of originalSell!.history; track $index) {
                <div class="text-xs text-gray-600 border-b last:border-0 pb-1">
                    <span class="font-semibold">{{ change.date | date:'dd/MM HH:mm' }}:</span>
                    <span>{{ change.field }} cambi√≥ de <span class="text-red-500 line-through">{{ change.oldValue
                            }}</span> a <span class="text-green-600 font-bold">{{ change.newValue }}</span></span>
                </div>
                }
            </div>
        </div>
        }
    </div>
    <div class="flex justify-end gap-2 p-4">
        <button
            class="bg-green-500 hover:bg-green-600 transition-colors duration-200 self-end text-white px-4 py-2 rounded"
            (click)="save(amount(), type(), comments())">Guardar</button>
        <button class="bg-red-500 hover:bg-red-600 transition-colors duration-200 self-end text-white px-4 py-2 rounded"
            (click)="close()">Cerrar</button>
    </div>
</div>